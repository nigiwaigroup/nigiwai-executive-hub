<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard: สรุปการแจกอั่งเปาตรุษจีน 2569</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #1a252f;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-color: #f4f6f9;
            --text-color: #2c3e50;
            --card-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 30px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            text-align: center;
            border-bottom: 4px solid var(--accent-color); /* Red accent for Angpao theme */
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            color: var(--primary-color);
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.1em;
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        .header .condition-tag {
            display: inline-block;
            background: #fdedec; /* Light red bg */
            color: #c0392b;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            border: 1px solid #fadbd8;
        }

        /* Criteria Section */
        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .criteria-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            border-left: 5px solid var(--accent-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .criteria-info h3 { margin: 0 0 5px 0; font-size: 1.1em; color: var(--primary-color); }
        .criteria-info p { margin: 0; font-size: 0.9em; color: #7f8c8d; }
        .criteria-amount { font-size: 1.4em; font-weight: 700; color: var(--accent-color); }

        /* Statistics Cards (Matches Main Dashboard) */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        .stat-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 5px; }
        .stat-card.blue::before { background: var(--secondary-color); }
        .stat-card.green::before { background: var(--success-color); }
        .stat-card.orange::before { background: var(--warning-color); }
        .stat-card.red::before { background: var(--accent-color); }

        .stat-title { font-size: 0.9rem; color: #7f8c8d; margin-bottom: 10px; }
        .stat-value { font-size: 2rem; font-weight: 700; color: var(--text-color); }
        .stat-unit { font-size: 0.8rem; color: #95a5a6; margin-left: 5px; }
        .stat-icon { float: right; font-size: 2rem; opacity: 0.1; color: var(--primary-color); }

        /* Section Title */
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        .section-header h2 { font-size: 1.5em; color: var(--primary-color); margin: 0; }
        .section-header i { margin-right: 10px; color: var(--secondary-color); }

        /* Department Section Layout */
        .dept-wrapper {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .dept-section {
            background: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            border-left: 5px solid var(--secondary-color); /* Default blue */
            overflow: hidden;
        }

        .dept-header {
            padding: 20px 30px;
            background: #fff;
            border-bottom: 1px solid #f0f2f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .dept-title {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--primary-color);
        }

        .dept-summary-box {
            display: flex;
            gap: 25px;
            background: #f8f9fa;
            padding: 8px 20px;
            border-radius: 30px;
            border: 1px solid #eee;
        }

        .ds-item {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .ds-label { font-size: 0.75em; color: #95a5a6; font-weight: 600; text-transform: uppercase; }
        .ds-value { font-size: 1.1em; font-weight: 700; color: var(--text-color); }
        .ds-value.money { color: var(--success-color); }

        /* Table */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
        }

        .dept-table {
            width: 100%;
            border-collapse: collapse;
        }

        .dept-table th {
            background: #fcfdfe;
            padding: 15px 30px;
            text-align: left;
            font-size: 0.9em;
            color: #7f8c8d;
            font-weight: 600;
            text-transform: uppercase;
            border-bottom: 1px solid #f0f2f5;
        }

        .dept-table td {
            padding: 15px 30px;
            border-bottom: 1px solid #f5f5f5;
            font-size: 0.95em;
            vertical-align: middle;
            color: #34495e;
        }

        .dept-table tr:last-child td { border-bottom: none; }
        .dept-table tr:hover { background: #f8f9fa; }

        .emp-name { font-weight: 600; color: var(--text-color); display: block; font-size: 1em; }
        .emp-id { font-size: 0.85em; color: #95a5a6; margin-left: 10px; font-weight: 400; background: #f0f2f5; padding: 2px 8px; border-radius: 4px; }
        .emp-duration { font-size: 0.9em; color: #7f8c8d; }
        .emp-money { font-weight: 700; text-align: right; font-size: 1.1em; }

        /* Money Badges */
        .money-badge { padding: 5px 12px; border-radius: 20px; font-size: 0.9em; display: inline-block; min-width: 80px; text-align: center; }
        .money-500 { color: #27ae60; background: #e8f8f5; }
        .money-300 { color: #f39c12; background: #fef9e7; }
        .money-200 { color: #e74c3c; background: #fdedec; }
        .money-0 { color: #bdc3c7; background: #f0f2f5; }

        .footer {
            text-align: center;
            padding: 40px 0;
            color: #95a5a6;
            font-size: 0.85em;
            border-top: 1px solid #e0e0e0;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            body { padding: 15px; }
            .header h1 { font-size: 1.6em; }
            .criteria-grid, .stats-grid { grid-template-columns: 1fr; }
            .dept-header { flex-direction: column; align-items: flex-start; }
            .dept-summary-box { width: 100%; justify-content: space-between; margin-top: 10px; }
            .dept-table th, .dept-table td { padding: 12px 15px; }
            .emp-id { display: inline-block; margin-top: 4px; }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <div class="header">
            <h1><i class="fas fa-envelope-open-text text-danger" style="color: #e74c3c;"></i> สรุปการแจกอั่งเปาตรุษจีน 2569</h1>
            <div class="subtitle">รายชื่อพนักงาน แยกรายแผนก เรียงตามอายุงาน</div>
            <div class="condition-tag">✅ รวมพนักงานทุกแผนก (Executive, Consultant, etc.)</div>
        </div>

        <div class="criteria-grid">
            <div class="criteria-card">
                <div class="criteria-info"><h3>ซองที่ 1</h3><p>อายุงาน 3 ปีขึ้นไป</p></div>
                <div class="criteria-amount">500 ฿</div>
            </div>
            <div class="criteria-card">
                <div class="criteria-info"><h3>ซองที่ 2</h3><p>อายุงาน 1-2 ปี</p></div>
                <div class="criteria-amount">300 ฿</div>
            </div>
            <div class="criteria-card">
                <div class="criteria-info"><h3>ซองที่ 3</h3><p>ต่ำกว่า 1 ปี</p></div>
                <div class="criteria-amount">200 ฿</div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card blue">
                <i class="fas fa-money-bill-wave stat-icon"></i>
                <div class="stat-title">งบประมาณรวม</div>
                <div class="stat-value" id="totalBudget">0<span class="stat-unit">บาท</span></div>
            </div>
            <div class="stat-card green">
                <i class="fas fa-users stat-icon"></i>
                <div class="stat-title">พนักงานทั้งหมด</div>
                <div class="stat-value" id="totalEmployees">0<span class="stat-unit">คน</span></div>
            </div>
            <div class="stat-card orange">
                <i class="fas fa-check-circle stat-icon"></i>
                <div class="stat-title">ได้รับซอง</div>
                <div class="stat-value" id="totalRecipients">0<span class="stat-unit">คน</span></div>
            </div>
            <div class="stat-card red">
                <i class="fas fa-chart-line stat-icon"></i>
                <div class="stat-title">เฉลี่ยต่อคน</div>
                <div class="stat-value" id="avgPerPerson">0<span class="stat-unit">บาท</span></div>
            </div>
        </div>

        <div class="section-header">
            <i class="fas fa-building fa-lg"></i>
            <h2>รายชื่อพนักงานแยกตามแผนก</h2>
        </div>
        
        <div class="dept-wrapper" id="deptContainer">
            </div>

        <div class="footer">
            © 2569 Nigiwai Group | Dashboard สรุปการแจกซองอั่งเปา (Executive Theme) <br>
            ข้อมูล ณ วันที่ 12 กุมภาพันธ์ 2569
        </div>
    </div>

    <script>
        // ข้อมูลดิบ
        const rawData = [
          {"รหัสพนักงาน":"610601","คำนำหน้า":"นาย","ชื่อ":"สุทธิพร","นามสกุล":"ตั้งสกุลสันติ","ชื่อเล่น":"คุณใหม่","แผนก":"Executive","วันเข้าทำงาน":"2018-06-12","อายุงาน":"7 ปี, 8 เดือน,","จำนวนเงิน":0},
          {"รหัสพนักงาน":"610602","คำนำหน้า":"นาย","ชื่อ":"วรันธร","นามสกุล":"แดงใหญ่","ชื่อเล่น":"คุณเก้ง","แผนก":"Executive","วันเข้าทำงาน":"2018-06-12","อายุงาน":"7 ปี, 8 เดือน,","จำนวนเงิน":0},
          {"รหัสพนักงาน":"610701","คำนำหน้า":"นางสาว","ชื่อ":"อรอริยา","นามสกุล":"สุดสุข","ชื่อเล่น":"ออน","แผนก":"Operation","วันเข้าทำงาน":"2018-07-08","อายุงาน":"7 ปี, 7 เดือน, 4 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"630601","คำนำหน้า":"นางสาว","ชื่อ":"ธนภรณ์","นามสกุล":"ผ่องประทุม","ชื่อเล่น":"เติ้ล","แผนก":"Marketing","วันเข้าทำงาน":"2020-06-16","อายุงาน":"5 ปี, 7 เดือน, 26 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"631202","คำนำหน้า":"นางสาว","ชื่อ":"สาริศา","นามสกุล":"กมลอรรฆ","ชื่อเล่น":"น้ำ","แผนก":"Executive","วันเข้าทำงาน":"2020-12-08","อายุงาน":"5 ปี, 2 เดือน, 4 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"631204","คำนำหน้า":"นาย","ชื่อ":"พงศธร","นามสกุล":"อภัยนุกูล","ชื่อเล่น":"บลู","แผนก":"Marketing","วันเข้าทำงาน":"2020-12-16","อายุงาน":"5 ปี, 1 เดือน, 27 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"640202","คำนำหน้า":"นางสาว","ชื่อ":"คณิตตา","นามสกุล":"จำเริญพงษ์","ชื่อเล่น":"ฝน","แผนก":"Warehouse & Logistics","วันเข้าทำงาน":"2021-02-16","อายุงาน":"4 ปี, 11 เดือน, 24 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"640502","คำนำหน้า":"นาย","ชื่อ":"ณรุจ","นามสกุล":"พลับศิริ","ชื่อเล่น":"โอ๊ต","แผนก":"Marketing","วันเข้าทำงาน":"2021-05-17","อายุงาน":"4 ปี, 8 เดือน, 26 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"640601","คำนำหน้า":"นาย","ชื่อ":"ไกรเจต","นามสกุล":"สมพงษ์","ชื่อเล่น":"เจต","แผนก":"Executive","วันเข้าทำงาน":"2021-06-01","อายุงาน":"4 ปี, 8 เดือน, 11 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"641001","คำนำหน้า":"นาย","ชื่อ":"วีระพจน์","นามสกุล":"สังเกตุ","ชื่อเล่น":"พจน์","แผนก":"Warehouse & Logistics","วันเข้าทำงาน":"2021-10-15","อายุงาน":"4 ปี, 3 เดือน, 28 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"641105","คำนำหน้า":"นาย","ชื่อ":"อรรถสิทธิ์","นามสกุล":"สุปัดคำ","ชื่อเล่น":"เก้","แผนก":"Construction","วันเข้าทำงาน":"2021-11-01","อายุงาน":"4 ปี, 3 เดือน, 11 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650102","คำนำหน้า":"นาย","ชื่อ":"วินัย","นามสกุล":"หนองแพ","ชื่อเล่น":"บู๊","แผนก":"Operation","วันเข้าทำงาน":"2021-12-03","อายุงาน":"4 ปี, 2 เดือน, 9 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"999901","คำนำหน้า":"นาย","ชื่อ":"สุวคนธ์","นามสกุล":"อินทร์ประคอง","ชื่อเล่น":"หมู","แผนก":"Consultant","วันเข้าทำงาน":"2022-01-01","อายุงาน":"4 ปี, 1 เดือน, 11 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"650106","คำนำหน้า":"นางสาว","ชื่อ":"นัชชา","นามสกุล":"ธนเกริกกวิน","ชื่อเล่น":"ป้อ","แผนก":"Sales","วันเข้าทำงาน":"2022-01-17","อายุงาน":"4 ปี, 26 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650104","คำนำหน้า":"นางสาว","ชื่อ":"ช้องนาง","นามสกุล":"หินขาว","ชื่อเล่น":"หนูนา","แผนก":"Operation","วันเข้าทำงาน":"2022-02-21","อายุงาน":"3 ปี, 11 เดือน, 19 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650206","คำนำหน้า":"นาย","ชื่อ":"กฤษฎา","นามสกุล":"จันทร์ฝา","ชื่อเล่น":"ภูมิ","แผนก":"Human Resource","วันเข้าทำงาน":"2022-02-23","อายุงาน":"3 ปี, 11 เดือน, 17 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650208","คำนำหน้า":"นาย","ชื่อ":"ขวัญวิชัย","นามสกุล":"ไกรงาม","ชื่อเล่น":"ชัย","แผนก":"Operation","วันเข้าทำงาน":"2022-02-24","อายุงาน":"3 ปี, 11 เดือน, 16 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650207","คำนำหน้า":"นางสาว","ชื่อ":"เสาวณี","นามสกุล":"พันสุวรรณ์","ชื่อเล่น":"บี","แผนก":"Operation","วันเข้าทำงาน":"2022-02-24","อายุงาน":"3 ปี, 11 เดือน, 16 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650702","คำนำหน้า":"นางสาว","ชื่อ":"อรนิดา","นามสกุล":"แพสถิตถาวร","ชื่อเล่น":"กุ๊ก","แผนก":"Human Resource","วันเข้าทำงาน":"2022-07-04","อายุงาน":"3 ปี, 7 เดือน, 8 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"650903","คำนำหน้า":"นาย","ชื่อ":"กันต์ศักย์","นามสกุล":"ปานมงคล","ชื่อเล่น":"อ้น","แผนก":"Operation","วันเข้าทำงาน":"2022-09-26","อายุงาน":"3 ปี, 4 เดือน, 16 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"651003","คำนำหน้า":"นางสาว","ชื่อ":"กชชลจรรย์","นามสกุล":"สุทธิกิตติพงศ์","ชื่อเล่น":"เมย์","แผนก":"Financial And Account","วันเข้าทำงาน":"2022-10-17","อายุงาน":"3 ปี, 3 เดือน, 26 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"651101","คำนำหน้า":"นางสาว","ชื่อ":"ณัฐชานันท์","นามสกุล":"ธนังชูศิลป์","ชื่อเล่น":"ชามุก","แผนก":"Sales","วันเข้าทำงาน":"2022-11-14","อายุงาน":"3 ปี, 2 เดือน, 28 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"651201","คำนำหน้า":"นางสาว","ชื่อ":"กนกพิชญ์","นามสกุล":"พิบูลย์","ชื่อเล่น":"ออ","แผนก":"Financial And Account","วันเข้าทำงาน":"2022-12-01","อายุงาน":"3 ปี, 2 เดือน, 11 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"660101","คำนำหน้า":"นางสาว","ชื่อ":"กรวรรณ","นามสกุล":"สุวรรณพรรค","ชื่อเล่น":"หมวย","แผนก":"Financial And Account","วันเข้าทำงาน":"2023-01-03","อายุงาน":"3 ปี, 1 เดือน, 9 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"660104","คำนำหน้า":"นางสาว","ชื่อ":"สาวิตรี","นามสกุล":"สิงห์เหม้น","ชื่อเล่น":"ทราย","แผนก":"Operation","วันเข้าทำงาน":"2023-01-05","อายุงาน":"3 ปี, 1 เดือน, 7 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"660201","คำนำหน้า":"นางสาว","ชื่อ":"ธิติญา","นามสกุล":"ปัญญายิ่ง","ชื่อเล่น":"อุ้ม","แผนก":"Marketing","วันเข้าทำงาน":"2023-02-08","อายุงาน":"3 ปี, 4 วัน","จำนวนเงิน":500},
          {"รหัสพนักงาน":"VV660302","คำนำหน้า":"นางสาว","ชื่อ":"ศิริวรรณ","นามสกุล":"กำรัตน์","ชื่อเล่น":"นิว","แผนก":"Operation","วันเข้าทำงาน":"2023-03-01","อายุงาน":"2 ปี, 11 เดือน, 11 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660401","คำนำหน้า":"นาย","ชื่อ":"พิชญา","นามสกุล":"บัวบรรจง","ชื่อเล่น":"พีพี","แผนก":"Information Technology","วันเข้าทำงาน":"2023-04-03","อายุงาน":"2 ปี, 10 เดือน, 9 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660409","คำนำหน้า":"นางสาว","ชื่อ":"พานทอง","นามสกุล":"รุ่งอนันต์กุลสิริ","ชื่อเล่น":"ปิงปิง","แผนก":"Human Resource","วันเข้าทำงาน":"2023-04-26","อายุงาน":"2 ปี, 9 เดือน, 16 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660504","คำนำหน้า":"นางสาว","ชื่อ":"ภัรตรา","นามสกุล":"เพ็ญภู่","ชื่อเล่น":"มะปราง","แผนก":"Sales","วันเข้าทำงาน":"2023-05-12","อายุงาน":"2 ปี, 9 เดือน,","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660503","คำนำหน้า":"นาย","ชื่อ":"ภูรินทร์","นามสกุล":"บุญวรรณ","ชื่อเล่น":"ก้อนเมฆ","แผนก":"Financial And Account","วันเข้าทำงาน":"2023-05-15","อายุงาน":"2 ปี, 8 เดือน, 28 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660801","คำนำหน้า":"นางสาว","ชื่อ":"ฐิติกานต์","นามสกุล":"รักเมือง","ชื่อเล่น":"หยก","แผนก":"Marketing","วันเข้าทำงาน":"2023-08-03","อายุงาน":"2 ปี, 6 เดือน, 9 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"660804","คำนำหน้า":"นาย","ชื่อ":"จิติวัฒน์","นามสกุล":"อุปวรรณะ","ชื่อเล่น":"นิว","แผนก":"Construction","วันเข้าทำงาน":"2023-08-15","อายุงาน":"2 ปี, 5 เดือน, 28 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"670202","คำนำหน้า":"นางสาว","ชื่อ":"กัลยรักษ์","นามสกุล":"ตระกูลอินทร์","ชื่อเล่น":"กุ้ง","แผนก":"Financial And Account","วันเข้าทำงาน":"2024-02-01","อายุงาน":"2 ปี, 11 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"670201","คำนำหน้า":"นาย","ชื่อ":"ศักดิ์จรินทร์","นามสกุล":"ดวงฤทัย","ชื่อเล่น":"เคน","แผนก":"Information Technology","วันเข้าทำงาน":"2024-02-05","อายุงาน":"2 ปี, 7 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"AS670308","คำนำหน้า":"นางสาว","ชื่อ":"มณีรัตน์","นามสกุล":"ธงทอง","ชื่อเล่น":"น้ำผึ้ง","แผนก":"Operation","วันเข้าทำงาน":"2024-03-01","อายุงาน":"1 ปี, 11 เดือน, 11 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"670401","คำนำหน้า":"นาย","ชื่อ":"พงศธร","นามสกุล":"โชติยะศิลป์","ชื่อเล่น":"แบงค์","แผนก":"Executive","วันเข้าทำงาน":"2024-04-04","อายุงาน":"1 ปี, 10 เดือน, 8 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"670601","คำนำหน้า":"นางสาว","ชื่อ":"รัตติกาล","นามสกุล":"สกุลอินทร์","ชื่อเล่น":"โบ","แผนก":"Sales","วันเข้าทำงาน":"2024-06-10","อายุงาน":"1 ปี, 8 เดือน, 2 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"671002","คำนำหน้า":"นาย","ชื่อ":"นิรันดร์","นามสกุล":"ดวงสุวรรณ","ชื่อเล่น":"อาร์ท","แผนก":"Construction","วันเข้าทำงาน":"2024-10-18","อายุงาน":"1 ปี, 3 เดือน, 25 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"671101","คำนำหน้า":"นางสาว","ชื่อ":"นุชนารถ","นามสกุล":"แตงอ่อน","ชื่อเล่น":"ถุงแป้ง","แผนก":"Construction","วันเข้าทำงาน":"2024-11-18","อายุงาน":"1 ปี, 2 เดือน, 24 วัน","จำนวนเงิน":300},
          {"รหัสพนักงาน":"999909","คำนำหน้า":"นาย","ชื่อ":"ญัตติพงศ์","นามสกุล":"พันธุ์ลิขิตอาภรณ์","ชื่อเล่น":"ไบร์ท","แผนก":"Consultant","วันเข้าทำงาน":"2025-05-01","อายุงาน":"9 เดือน, 11 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"999911","คำนำหน้า":"นาย","ชื่อ":"ถิรวุฒิ","นามสกุล":"รุจิราวรรณ","ชื่อเล่น":"ท๊อป","แผนก":"Consultant","วันเข้าทำงาน":"2025-09-01","อายุงาน":"5 เดือน, 11 วัน","จำนวนเงิน":0},
          {"รหัสพนักงาน":"680901","คำนำหน้า":"นาย","ชื่อ":"ณัฐกิตติ์","นามสกุล":"ต้นโต","ชื่อเล่น":"ที","แผนก":"Warehouse & Logistics","วันเข้าทำงาน":"2025-09-08","อายุงาน":"5 เดือน, 4 วัน","จำนวนเงิน":200},
          {"รหัสพนักงาน":"681001","คำนำหน้า":"นางสาว","ชื่อ":"พรวิไล","นามสกุล":"มีชัย","ชื่อเล่น":"ออน","แผนก":"Warehouse & Logistics","วันเข้าทำงาน":"2025-10-01","อายุงาน":"4 เดือน, 11 วัน","จำนวนเงิน":200},
          {"รหัสพนักงาน":"681101","คำนำหน้า":"นาย","ชื่อ":"ภัทรพล","นามสกุล":"เดือนฉาย","ชื่อเล่น":"ฟัด","แผนก":"Human Resource","วันเข้าทำงาน":"2025-10-30","อายุงาน":"3 เดือน, 13 วัน","จำนวนเงิน":200},
          {"รหัสพนักงาน":"681102","คำนำหน้า":"นางสาว","ชื่อ":"วิภาวี","นามสกุล":"เรืองจรูญ","ชื่อเล่น":"บิว","แผนก":"Human Resource","วันเข้าทำงาน":"2025-11-17","อายุงาน":"2 เดือน, 25 วัน","จำนวนเงิน":200}
        ];

        const employeeData = rawData;
        let totalBudget = 0;
        let recipients = 0;
        let deptMap = {};
        const formatMoney = (num) => new Intl.NumberFormat('th-TH').format(num);

        // Updated Colors to match Nigiwai Theme
        const deptColors = {
            'Executive': '#2c3e50', // Dark Blue
            'Operation': '#27ae60', // Green
            'Marketing': '#3498db', // Blue
            'Sales': '#f39c12',     // Orange
            'Financial And Account': '#8e44ad', // Purple
            'Human Resource': '#e84393', // Pink
            'Warehouse & Logistics': '#2980b9', // Darker Blue
            'Construction': '#7f8c8d', // Grey
            'Information Technology': '#16a085', // Teal
            'Consultant': '#34495e' // Navy
        };

        employeeData.forEach(emp => {
            totalBudget += emp.จำนวนเงิน;
            if (emp.จำนวนเงิน > 0) recipients++;
            if (!deptMap[emp.แผนก]) deptMap[emp.แผนก] = { name: emp.แผนก, count: 0, money: 0, employees: [] };
            deptMap[emp.แผนก].count++;
            deptMap[emp.แผนก].money += emp.จำนวนเงิน;
            deptMap[emp.แผนก].employees.push(emp);
        });

        document.getElementById('totalBudget').innerHTML = `${formatMoney(totalBudget)}<span class="stat-unit">บาท</span>`;
        document.getElementById('totalEmployees').innerHTML = `${employeeData.length}<span class="stat-unit">คน</span>`;
        document.getElementById('totalRecipients').innerHTML = `${recipients}<span class="stat-unit">คน</span>`;
        document.getElementById('avgPerPerson').innerHTML = `${formatMoney((totalBudget / employeeData.length).toFixed(0))}<span class="stat-unit">บาท</span>`;

        const deptContainer = document.getElementById('deptContainer');
        const sortedDepts = Object.values(deptMap).sort((a, b) => b.money - a.money);

        sortedDepts.forEach(dept => {
            const section = document.createElement('div');
            section.className = 'dept-section';
            const color = deptColors[dept.name] || '#3498db';
            section.style.borderLeftColor = color;

            let empRowsHtml = '';
            dept.employees.forEach(emp => {
                // Use class based badges for money
                const moneyClass = emp.จำนวนเงิน >= 500 ? 'money-500' : (emp.จำนวนเงิน >= 300 ? 'money-300' : (emp.จำนวนเงิน >= 200 ? 'money-200' : 'money-0'));
                const moneyText = emp.จำนวนเงิน > 0 ? `${formatMoney(emp.จำนวนเงิน)}` : '-';
                
                empRowsHtml += `
                    <tr>
                        <td>
                            <span class="emp-name">${emp.คำนำหน้า}${emp.ชื่อ} ${emp.นามสกุล} (${emp.ชื่อเล่น})
                                <span class="emp-id">#${emp.รหัสพนักงาน}</span>
                            </span>
                        </td>
                        <td><span class="emp-duration">${emp.อายุงาน}</span></td>
                        <td class="emp-money"><span class="money-badge ${moneyClass}">${moneyText}</span></td>
                    </tr>
                `;
            });

            section.innerHTML = `
                <div class="dept-header">
                    <div class="dept-title" style="color:${color}">${dept.name}</div>
                    <div class="dept-summary-box">
                        <div class="ds-item"><span class="ds-label">พนักงาน</span><span class="ds-value">${dept.count} <span style="font-size:0.7em">คน</span></span></div>
                        <div class="ds-item"><span class="ds-label">รวมเงิน</span><span class="ds-value money" style="color:${color}">${formatMoney(dept.money)} <span style="font-size:0.7em">฿</span></span></div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="dept-table">
                        <thead><tr><th width="50%">ชื่อ - นามสกุล</th><th width="35%">อายุงาน</th><th width="15%" style="text-align:right">ยอดเงิน</th></tr></thead>
                        <tbody>${empRowsHtml}</tbody>
                    </table>
                </div>
            `;
            deptContainer.appendChild(section);
        });
    </script>
</body>
</html>
